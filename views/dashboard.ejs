<%- include('layouts/navbar.ejs', { user: user }) %>

<main class="relative grid w-full grid-cols-2 gap-8 p-4">

  <% if (fail) { %>
  <div class="absolute flex items-center gap-2 p-4 mt-8 ml-8 bg-orange-200 border-2 border-black w-max rounded-xl">
    <h3 class="font-semibold"><%= fail %></h3>
    <svg width="40" height="40" class="cursor-pointer" onclick="this.parentNode.remove()">
      <circle cx="20" cy="20" r="15" fill="#ef4444" />
      <text fill="#f5f5f5" font-size="25" font-weight="700" x="14" y="26">x</text>
    </svg>
  </div>
  <% } %>

  <div class="px-2 py-1 text-xl bg-white bg-opacity-50 border-2 border-black rounded-xl">

    <h3 class="font-bold">Mi perfil:</h3>
    <form class="flex flex-col gap-2 px-6" id="updateForm" action="/dashboard/update?_method=PUT" method="POST">

      <p>Nombre de usuario:</p>
      <p class="input"><%= user.username %></p>

      <p>Email</p>
      <p class="input"><%= user.email %></p>

      <p>Nombre</p>
      <p class="input"><%= user.firstname %></p>

      <p>Apellido</p>
      <p class="input"><%= user.lastname %></p>

      <label for="cellphone">Celular <small>(modificable)</small></label>
      <input type="text" value="<%= user.cellphone ? user.cellphone : '' %>" id="cellphone" placeholder="Celular" name="cellphone">

      <label for="profile_pic">Imagen de perfil (url) <small>(modificable)</small></label>
      <input type="text" value="<%= user.profile_pic %>" id="profile_pic" placeholder="Imagen de perfil (url)" name="profile_pic">

      <button class="px-2 text-xl font-bold bg-red-500 border-2 border-black rounded-xl">Actualizar</button>

    </form>
  </div>

  <div class="px-2 py-1 text-xl bg-white bg-opacity-50 border-2 border-black rounded-xl">

    <h3 class="font-bold">Ofrecer nuevo libro:</h3>
    <form class="flex flex-col gap-2 px-6" id="newBookForm" action="/books/create" method="POST">

      <label for="title">Título*</label>
      <input type="text" placeholder="Título" name="title" id="title" required>

      <label for="author">Autor*</label>
      <input type="text" placeholder="Autor" name="author" id="author" required>

      <label for="year">Fecha de publicación*</label>
      <input type="text" placeholder="Publicación" name="year" id="year" required>

      <label for="publisher">Editorial*</label>
      <input type="text" placeholder="Editorial" name="publisher" id="publisher" required>

      <label for="price">Precio de alquiler ($)*</label>
      <input type="number" min="0" placeholder="Precio de alquiler ($)" name="price" id="price" required>

      <label for="period">Duración del alquiler*</label>
      <input type="text" placeholder="Duración del alquiler" name="period" id="period" required>

      <label for="category">Categoría</label>
      <input type="text" placeholder="Categoría" name="category" id="category">

      <label for="cover_image">Imagen de portada (url)</label>
      <input type="text" placeholder="Imagen de portada (url)" name="cover_image" id="cover_image">

      <button class="px-2 text-xl font-bold bg-red-500 border-2 border-black rounded-xl">Agregar</button>

      <small>* requerido</small>
    </form>
  </div>

  <div class="px-2 py-1 text-xl bg-white bg-opacity-50 border-2 border-black rounded-xl">

    <h3 class="font-bold">Usuarios que sigo:</h3>
    <div class="grid grid-cols-2 gap-4 px-6">
      <% if (followings.length > 0) { %>
      <% followings.forEach(relation => { %>
      <a class="px-2 py-1 mt-auto text-center bg-orange-500 border-2 border-black rounded-xl" href="/dashboard/search/<%= relation.following %>"><%= relation.following %></a>
      <a class="px-2 py-1 mt-auto text-center bg-red-500 border-2 border-black rounded-xl" href="/follow/unfollow/<%= relation.following %>">Dejar de seguir</a>
      <% }) %>
      <% } else { %>
      <p class="col-span-2 text-xl font-bold underline">No sigues a ningún usuario.</p>
      <% } %>
    </div>

  </div>

</main>

</body>

</html>